<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1, minimum-scale=1">
  <title>Space Tetris ‚Äì Responsive Edition</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      background:black;
      font-family:Arial, sans-serif;
      overflow:hidden;
      height:100vh;
      width:100vw;
      display:flex;
      justify-content:center;
      align-items:center;
      -webkit-tap-highlight-color: transparent;
    }

    #start-screen {
      position:absolute;
      inset:0;
      background:radial-gradient(#020617,#000);
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      z-index:10;
    }

    #start-logo {
      font-size:8vw;
      color:#6fbaff;
      text-shadow:0 0 8px #6fbaff,0 0 18px #3d7bff;
      letter-spacing:0.8vw;
      margin-bottom:4vh;
    }

    #startBtn {
      padding:3vw 7vw;
      border:0.8vw solid #6fbaff;
      border-radius:2vw;
      font-size:6vw;
      text-align:center;
      color:#6fbaff;
      background:black;
      box-shadow:0 0 4vw #6fbaff;
    }

    #game-container {
      display:none;
      flex-direction:column;
      align-items:center;
      width:100vw;
      height:100vh;
      padding-top:2vh;
    }

    #ui {
      font-size:4vw;
      margin-bottom:1vh;
      color:white;
      text-align:center;
    }

    #tetris {
      width:90vw;
      max-width:430px;
      aspect-ratio:1/2;
      border:0.8vw solid #6fbaff;
      background:black;
      box-shadow:0 0 3vw #6fbaff;
      touch-action:none;
    }

    #controls {
      display:flex;
      justify-content:center;
      gap:4vw;
      margin-top:2vh;
      padding-bottom:3vh;
    }

    .control-btn {
      width:14vw;
      height:14vw;
      max-width:80px;
      max-height:80px;
      background:#111;
      border:0.8vw solid #6fbaff;
      border-radius:2vw;
      font-size:7vw;
      color:#6fbaff;
      display:flex;
      justify-content:center;
      align-items:center;
      user-select:none;
      box-shadow:0 0 3vw #6fbaff;
      -webkit-tap-highlight-color: transparent;
    }

    .control-btn:active {
      transform:scale(0.92);
      filter:brightness(1.4);
    }

    #fullscreenBtn {
      font-size:5vw;
      width:12vw;
      height:12vw;
      max-width:70px;
      max-height:70px;
      margin-top:2vh;
    }

    #gameover-screen {
      position:absolute;
      inset:0;
      background:radial-gradient(#000428,#004e92);
      display:none;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      z-index:20;
      text-shadow:0 0 8px #6fbaff;
    }

    #restartBtn {
      padding:3vw 7vw;
      border:0.8vw solid #6fbaff;
      border-radius:2vw;
      font-size:6vw;
      background:black;
      color:#6fbaff;
      margin-top:3vh;
      box-shadow:0 0 4vw #6fbaff;
    }
  </style>
</head>
<body>

<!-- START SCREEN -->
<div id="start-screen">
  <div id="start-logo">SPACE TETRIS</div>
  <div id="startBtn">START</div>
</div>

<!-- GAME CONTAINER -->
<div id="game-container">
  <div id="ui">
    Score: <span id="score">0</span> |
    Level: <span id="level">1</span> |
    Time: <span id="time">0</span>s
  </div>

  <canvas id="tetris"></canvas>

  <div id="controls">
    <div class="control-btn" id="left">‚¨ÖÔ∏è</div>
    <div class="control-btn" id="rotate">üîÑ</div>
    <div class="control-btn" id="right">‚û°Ô∏è</div>
    <div class="control-btn" id="down">‚¨áÔ∏è</div>
  </div>

  <div id="fullscreenBtn" class="control-btn">‚õ∂</div>
</div>

<!-- GAME OVER SCREEN -->
<div id="gameover-screen">
  <div style="font-size:10vw; margin-bottom:3vh; letter-spacing:1vw;">GAME OVER</div>
  <div style="font-size:5vw;">Score: <span id="final-score"></span></div>
  <div style="font-size:5vw;">Level: <span id="final-level"></span></div>
  <div style="font-size:5vw; margin-bottom:4vh;">Time: <span id="final-time"></span>s</div>
  <div id="restartBtn">RESTART</div>
</div>

<script>
document.getElementById("startBtn").onclick = () => {
  document.getElementById("start-screen").style.display="none";
  document.getElementById("game-container").style.display="flex";
  startGame();
};

let canvas, ctx;
let gridW=10, gridH=20, block;
let score=0, level=1, time=0;
let grid, piece, px, py;
let last=0, drop=0, paused=true;

const shapes=[
  [[1,1,1,1]],
  [[1,1],[1,1]],
  [[0,1,0],[1,1,1]],
  [[1,0],[1,0],[1,1]],
  [[0,1],[0,1],[1,1]]
];

const colors=["#6fbaff","#94ccff","#c7e5ff","#ffffff"];

function startGame(){
  canvas = document.getElementById("tetris");
  ctx = canvas.getContext("2d");

  // Make canvas match visual size
  canvas.width = canvas.getBoundingClientRect().width;
  canvas.height = canvas.width * 2;
  block = canvas.width / gridW;

  initGrid();
  newPiece();
  paused = false;
  update(0);

  setInterval(() => {
    if (!paused) {
      time++;
      document.getElementById("time").textContent = time;
    }
  }, 1000);
}

function initGrid(){
  grid=Array(gridH).fill().map(()=>Array(gridW).fill(0));
}

function newPiece(){
  piece=shapes[Math.random()*shapes.length|0];
  px=3; py=0;
}

function rotate(p){
  return p[0].map((_,i)=>p.map(r=>r[i]).reverse());
}

function collides(nx,ny,p){
  for(let y=0;y<p.length;y++){
    for(let x=0;x<p[y].length;x++){
      if(p[y][x] &&
        (nx+x<0||nx+x>=gridW||ny+y>=gridH||grid[ny+y][nx+x])) return true;
    }
  }
  return false;
}

function merge(){
  piece.forEach((r,y)=>r.forEach((v,x)=>{
    if(v) grid[py+y][px+x]=1;
  }));
}

function clearLines(){
  for(let y=gridH-1;y>=0;y--){
    if(grid[y].every(v=>v)){
      grid.splice(y,1);
      grid.unshift(Array(gridW).fill(0));
      score+=100;
      level=Math.floor(score/500)+1;
    }
  }
  document.getElementById("score").textContent=score;
  document.getElementById("level").textContent=level;
}

let stars=[];
for(let i=0;i<80;i++){
  stars.push({x:Math.random()*300,y:Math.random()*600,s:Math.random()*2,sp:0.4+Math.random()*0.5});
}

function drawStars(){
  ctx.fillStyle="white";
  for(let s of stars){
    ctx.globalAlpha=0.3;
    ctx.fillRect(s.x,s.y,s.s,s.s);
    s.y+=s.sp;
    if(s.y>canvas.height){s.y=0; s.x=Math.random()*canvas.width;}
  }
  ctx.globalAlpha=1;
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawStars();

  for(let y=0;y<gridH;y++){
    for(let x=0;x<gridW;x++){
      if(grid[y][x]){
        ctx.fillStyle=colors[(x+y)%4];
        ctx.fillRect(x*block,y*block,block-1,block-1);
      }
    }
  }

  piece.forEach((r,y)=>
    r.forEach((v,x)=>{
      if(v){
        ctx.fillStyle=colors[(x+y)%4];
        ctx.fillRect((px+x)*block,(py+y)*block,block-1,block-1);
      }
    })
  );
}

function update(t){
  requestAnimationFrame(update);
  if(paused) return;

  let d=t-last;
  last=t;
  drop+=d;

  if(drop > 900 - level*60){
    py++;
    drop=0;

    if(collides(px,py,piece)){
      py--;
      merge();
      clearLines();
      newPiece();

      if(collides(px,py,piece)){
        gameOver();
        return;
      }
    }
  }
  draw();
}

function gameOver(){
  paused=true;
  document.getElementById("final-score").textContent=score;
  document.getElementById("final-level").textContent=level;
  document.getElementById("final-time").textContent=time;
  document.getElementById("gameover-screen").style.display="flex";
}

document.getElementById("restartBtn").onclick = ()=>location.reload();

// TOUCH CONTROLS
left.onclick = () => { if(!collides(px-1,py,piece)) px--; };
right.onclick = () => { if(!collides(px+1,py,piece)) px++; };
rotate.onclick = () => { let r=rotate(piece); if(!collides(px,py,r)) piece=r; };
down.onclick = () => { py++; if(collides(px,py,piece)) py--; };

// TOUCH SWIPE
let touchStartX = 0, touchStartY = 0;
canvas.addEventListener("touchstart", (e) => {
  const t = e.touches[0];
  touchStartX = t.clientX;
  touchStartY = t.clientY;
});
canvas.addEventListener("touchend", (e) => {
  const t = e.changedTouches[0];
  const dx = t.clientX - touchStartX;
  const dy = t.clientY - touchStartY;

  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 20) right.onclick();
    else if (dx < -20) left.onclick();
  } else {
    if (dy > 20) down.onclick();
    else if (dy < -20) rotate.onclick();
  }
});

// FULLSCREEN TOGGLE
document.getElementById("fullscreenBtn").onclick = () => {
  const elem = document.documentElement;
  if (!document.fullscreenElement) {
    if (elem.requestFullscreen) {
      elem.requestFullscreen();
    } else if (elem.webkitRequestFullscreen) {
      elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) {
      elem.msRequestFullscreen();
    }
  } else {
    if (document.exitFullscreen) {
      document.exitFullscreen();
    } else if (document.webkitExitFullscreen) {
      document.webkitExitFullscreen();
    } else if (document.msExitFullscreen) {
      document.msExitFullscreen();
    }
  }
};
</script>
</body>
</html>
